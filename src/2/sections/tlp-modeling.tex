\section{Application to a real TLP generator}
\label{sec:tlp-modeling}

The methodology described in section \ref{sec:esd-modeling} was applied and validated on the actual TLP bench at NXP laboratory in Toulouse.
The modeling was validated by injecting at different levels on different loads.
The complete model is detailed Fig. \ref{fig:complete-tlp-model}.

%TODO: Detail complete model a lot

\begin{figure}[!h]
  \centering
  \includegraphics[width=0.3\textwidth]{src/1/figures/complete_nxp_tlp_model.pdf}
  \caption{Complete model of NXP laboratory's TLP generator}
  \label{fig:complete-tlp-model}
\end{figure}

Simulation versus measurement curves for each different load will be given at 3.5 A (500 V TLP charging voltage).
Curves at 75 mA (10 V) and 7.5 A (1000 V) will be given in annex ?
The setup is identical for each simulation/measurement and is given Fig. \ref{fig:setup-cz-tlp-model}.

\begin{figure}[!h]
  \centering
  \includegraphics[width=0.3\textwidth]{src/1/figures/tlp_characterization_setup.pdf}
  \caption{Characterization setup of the TLP}
  \label{fig:setup-cz-tlp-model}
\end{figure}

First comparison in Fig. \ref{fig:comparison-tlp-1-v} and \ref{fig:comparison-tlp-1-i}.
A 25\textOmega{} resistor allows validating the model with voltage across the load and current flowing through it. The correlation is good and so far the model is rather accurate. The ration of Vtlp/Itlp between 40 ns to 100 ns is equal to the load resistance 25\textOmega{}.


\begin{figure}[!h]
  \centering
  \includegraphics[width=0.3\textwidth]{src/1/figures/tlp_comparison_25ohm_voltage.png}
  \caption{Voltage measurement versus simulation - XX V charging voltage on XX\textOmega{}}
  \label{fig:comparison-tlp-1-v}
\end{figure}

\begin{figure}[!h]
  \centering
  \includegraphics[width=0.3\textwidth]{src/1/figures/tlp_comparison_25ohm_current.png}
  \caption{Current measurement versus simulation - XX V charging voltage on XX\textOmega{}}
  \label{fig:comparison-tlp-1-i}
\end{figure}

Same comparison is performed on a short circuit in Fig. \ref{fig:comparison-tlp-short-v} and Fig. \ref{fig:comparison-tlp-short-i}.
The goal is to test the extreme conditions where the model is going to be used.
As expected the voltage is null and the current is close to the maximum 10A supplied by the TLP (500 V through 50\textOmega{}).
The same issue with probe clamping happens now with both voltage and current at exactly -100V and -5A.

\begin{figure}[!h]
  \centering
  \includegraphics[width=0.3\textwidth]{src/1/figures/tlp_comparison_short_voltage.png}
  \caption{Voltage measurement versus simulation - XX V charging voltage on a short circuit}
  \label{fig:comparison-tlp-short-v}
\end{figure}

\begin{figure}[!h]
  \centering
  \includegraphics[width=0.3\textwidth]{src/1/figures/tlp_comparison_short_current.png}
  \caption{Current measurement versus simulation - XX V charging voltage on a short circuit}
  \label{fig:comparison-tlp-short-i}
\end{figure}

Finally, the process is repeated on an open circuit in Fig. X and Fig. X

After 50 ns, voltage and current are stable.
The voltage is 250V which corresponds to half the TLP charging voltage, and the current is close to 0A.
This is expected behavior for a high impedance load.

On the current response (bottom), between 100ns and 120ns there is a significant difference between measurement and simulation.
This is simply due to the current probe clamping the current at -1A, because it exceeds the measurable range.
Since it is simply a measurement error it is not modeled.

\begin{figure}[!h]
  \centering
  \includegraphics[width=0.3\textwidth]{src/1/figures/tlp_comparison_open_voltage.png}
  \caption{Voltage measurement versus simulation - XX V charging voltage on open circuit}
  \label{fig:comparison-tlp-1-v}
\end{figure}

\begin{figure}[!h]
  \centering
  \includegraphics[width=0.3\textwidth]{src/1/figures/tlp_comparison_open_current.png}
  \caption{Current measurement versus simulation - XX V charging voltage on open circuit}
  \label{fig:comparison-tlp-1-i}
\end{figure}

Finally, only resistive loads were tested
Using a capacitor as load allows validating the model with non-purely real impedance.
Between 40 ns and 100 ns, voltage and current are not stable because the capacitor is too big to be fully charged at half the TLP charging voltage.
Because the TLP is closer to a current source than a voltage source, the capacitor is charged up at almost constant current, and its voltage rises linearly.
The slope of this linear curve is directly related to the capacitor value.
By extrapolation it is possible to measure the capacitor value from the TLP curve ?

\begin{figure}[!h]
  \centering
  \includegraphics[width=0.3\textwidth]{src/1/figures/tlp_comparison_capa_voltage.png}
  \caption{Voltage measurement versus simulation - XX V charging voltage on a 4nF capacitor}
  \label{fig:comparison-tlp-capa-v}
\end{figure}

\begin{figure}[!h]
  \centering
  \includegraphics[width=0.3\textwidth]{src/1/figures/tlp_comparison_capa_current.png}
  \caption{Current measurement versus simulation - XX V charging voltage on 4nF capacitor}
  \label{fig:comparison-tlp-capa-i}
\end{figure}

More simulations were run to ensure the model performs correctly at different charging voltages, etc
Goal is to validate it at its nominal and boundary conditions
Curves are given in Annex XX
%TODO: Mettre courbes en annexe
Overall, model is good and fits very well the measurements.
